---
suite: test repository manifest
templates:
  - deployment-repository.yaml
  - config-repository.yaml
  - secret-database.yaml
  - secret-s3.yaml
  - config-dev-log4j-properties.yaml
tests:
  - it: should have basic metadata in place
    values: &testvalues
      - values/test_values.yaml
    asserts:
      - equal:
          path: metadata.name
          value: RELEASE-NAME-alfresco-cs-repository
      - equal:
          path: spec.template.metadata.annotations.checksum/config
          value: 65b89491b06b9ccd8146424a8eab9d7a9d109a18db722e1276f1223ee37fd47c
  - it: should have basic metadata in place
    values: &testvalues
      - values/test_values.yaml
    asserts:
      - equal:
          path: metadata.name
          value: RELEASE-NAME-alfresco-cs-repository-configmap
        template: config-repository.yaml
      - matchRegex:
          path: data.CATALINA_OPTS
          pattern: -Dencryption.ssl.truststore.location=/.*
        template: config-repository.yaml