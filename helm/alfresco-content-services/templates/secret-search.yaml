{{- if not .Values.global.search.existingSecretName }}
{{- $search_flavor := (include "alfresco-content-services.search.flavor" .) }}
{{- if ne "noindex" $search_flavor }}
{{- with .Values.global }}
apiVersion: v1
kind: Secret
metadata:
  name: {{ .search.secretName }}
  labels:
    {{- include "alfresco-content-services.labels" $ | nindent 4 }}
type: Opaque
data:
{{- if eq "solr6" $search_flavor }}
  SOLR_SECRET: {{ .search.sharedSecret | default "" | b64enc | quote }}
{{- else if eq "elasticsearch" $search_flavor }}
  SEARCH_USERNAME: {{ .search.username | default "" | b64enc | quote }}
  SEARCH_PASSWORD: {{ .search.password | default "" | b64enc | quote }}
{{- end }}
  AUDIT_ELASTICSEARCH_USERNAME: {{ .auditIndex.username | default "" | b64enc | quote }}
  AUDIT_ELASTICSEARCH_PASSWORD: {{ .auditIndex.password | default "" | b64enc | quote }}
  elasticsearch-password: {{ .auditIndex.password | default "" | b64enc | quote }}
  kibana-password: {{ .auditIndex.password | default "" | b64enc | quote }}
{{- end }}
{{- end }}
{{- end }}
