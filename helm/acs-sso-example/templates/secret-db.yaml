apiVersion: v1
kind: Secret
metadata:
  name: repository-database
  labels: {{- include "acs-sso-example.labels" . | nindent 4 }}
data:
{{- with (index .Values "repository-database") }}
  {{- $glob := $.Values.global | default dict }}
  {{- $pgglob := $glob.postgresql | default dict }}
  {{- $pgglob = $pgglob.auth | default dict }}
  DATABASE_USERNAME: {{ coalesce $pgglob.username .primary.auth.username | b64enc | quote }}
  DATABASE_PASSWORD: {{ coalesce $pgglob.password .primary.auth.password | b64enc | quote }}
{{- end }}
